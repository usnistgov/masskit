
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>&lt;no title&gt; &#8212; masskit 1.2.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/nature.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
<link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
  <script src="https://code.jquery.com/jquery-1.12.4.min.js" type="text/javascript"></script>
  <script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>


<script type="text/javascript" src="https://pages.nist.gov/leaveNotice/js/jquery.leaveNotice-nist.min.js"></script>
<script>
$(document).ready(function(){
  // Mark external (non-nist.gov) A tags with class "external"
  //If the adress start with https and ends with nist.gov
  var re_nist = new RegExp('^https?:\/\/((^\/)*\.)*nist\\.gov(\/|$)');
  //Regex to find address that start with https
  var re_absolute_address = new RegExp('^((https?:)?\/\/)');
  $("a").each(function(){
    var url=$(this).attr('href');
    if(re_nist.test(url) || !re_absolute_address.test(url)){
      $(this).addClass('local');
    }else{
      //This a href appears to be external, so tag it
      $(this).addClass('external');
    }
  });
  // Add leaveNotice to external A elements
  $('a.external').leaveNotice();
});
</script>
<link rel="stylesheet" type="text/css" href="https://pages.nist.gov/leaveNotice/css/jquery.leaveNotice.css" />


  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">masskit 1.2.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">&lt;no title&gt;</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="ch">#!python</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>
<span class="kn">import</span> <span class="nn">pyarrow.parquet</span> <span class="k">as</span> <span class="nn">pq</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">types</span> <span class="kn">import</span> <span class="n">MethodType</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ALPHABET</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">random_string</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">ALPHABET</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">length</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">create_dataset</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="n">ALPHABET</span><span class="p">):</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">cols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">rows</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">cols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="nb">float</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">rows</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">cols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">vfunc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">random_string</span><span class="p">)</span>
            <span class="n">rand_lengths</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">rows</span><span class="p">)</span>
            <span class="n">data</span><span class="p">[</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">vfunc</span><span class="p">(</span><span class="n">rand_lengths</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">cols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">larr</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
                <span class="n">rand_length</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">lst</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">rand_length</span><span class="p">)</span>
                <span class="n">larr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
            <span class="n">data</span><span class="p">[</span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">larr</span>
    <span class="k">return</span> <span class="n">pa</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">table_to_struct</span><span class="p">(</span><span class="n">table</span><span class="p">):</span>
    <span class="n">fields</span><span class="p">,</span> <span class="n">arrs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">column_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">num_columns</span><span class="p">):</span>
        <span class="n">fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">column_index</span><span class="p">))</span>
        <span class="n">arrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">column_index</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">chunks</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">pa</span><span class="o">.</span><span class="n">StructArray</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">(</span><span class="n">arrs</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="n">fields</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">struct_to_table</span><span class="p">(</span><span class="n">struct</span><span class="p">):</span>
    <span class="n">fields</span><span class="p">,</span> <span class="n">arrs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">struct</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">arrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">pa</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">arrs</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">struct_view</span><span class="p">(</span><span class="n">struct_name</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">struct_accessor</span><span class="p">:</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">struct_name</span> <span class="o">=</span> <span class="n">name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>

        <span class="k">def</span> <span class="nf">struct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">struct_name</span><span class="p">)</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">attr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">attr</span> <span class="o">==</span> <span class="n">MethodType</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">attr</span><span class="p">()</span>
                <span class="k">return</span> <span class="n">attr</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">add_accessor_fn</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
        <span class="n">fn_name</span> <span class="o">=</span> <span class="n">name</span>

        <span class="k">def</span> <span class="nf">fn_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">struct</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">fn_scalar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">struct</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">as_py</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pa</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_list</span><span class="p">(</span><span class="nb">type</span><span class="p">)</span> <span class="ow">or</span> <span class="n">pa</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_large_list</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">fn_name</span><span class="p">,</span> <span class="n">MethodType</span><span class="p">(</span><span class="n">fn_list</span><span class="p">,</span> <span class="n">inst</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">pa</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_struct</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">fn_name</span><span class="p">,</span> <span class="n">MethodType</span><span class="p">(</span><span class="n">fn_scalar</span><span class="p">,</span> <span class="n">inst</span><span class="p">))</span>

    <span class="n">inst</span> <span class="o">=</span> <span class="n">struct_accessor</span><span class="p">(</span><span class="n">struct_name</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">inst</span><span class="o">.</span><span class="n">struct</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">add_accessor_fn</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">inst</span>



<span class="k">def</span> <span class="nf">row_view</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">row_accessor</span><span class="p">:</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="n">table</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span>

        <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">attr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">attr</span> <span class="o">==</span> <span class="n">MethodType</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">attr</span><span class="p">()</span>
                <span class="k">return</span> <span class="n">attr</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">add_accessor_fn</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
        <span class="c1">#fn_name = &quot;get_&quot; + name</span>
        <span class="n">fn_name</span> <span class="o">=</span> <span class="n">name</span>

        <span class="k">def</span> <span class="nf">fn_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="k">if</span> <span class="n">values</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">values</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">def</span> <span class="nf">fn_scalar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">as_py</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pa</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_list</span><span class="p">(</span><span class="nb">type</span><span class="p">)</span> <span class="ow">or</span> <span class="n">pa</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_large_list</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">fn_name</span><span class="p">,</span> <span class="n">MethodType</span><span class="p">(</span><span class="n">fn_list</span><span class="p">,</span> <span class="n">inst</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">pa</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_struct</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
            <span class="n">sv</span> <span class="o">=</span> <span class="n">struct_view</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">inst</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">fn_name</span><span class="p">,</span> <span class="n">sv</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">fn_name</span><span class="p">,</span> <span class="n">MethodType</span><span class="p">(</span><span class="n">fn_scalar</span><span class="p">,</span> <span class="n">inst</span><span class="p">))</span>

    <span class="n">inst</span> <span class="o">=</span> <span class="n">row_accessor</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">column_names</span><span class="p">:</span>
        <span class="n">add_accessor_fn</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">inst</span>

<span class="k">def</span> <span class="nf">row_view_raw</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">row_accessor</span><span class="p">:</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="n">table</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span>

    <span class="k">def</span> <span class="nf">add_accessor_fn</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
        <span class="n">fn_name</span> <span class="o">=</span> <span class="s2">&quot;get_&quot;</span> <span class="o">+</span> <span class="n">name</span>
        <span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">fn_name</span><span class="p">,</span> <span class="n">MethodType</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">inst</span><span class="p">))</span>

    <span class="n">inst</span> <span class="o">=</span> <span class="n">row_accessor</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">column_names</span><span class="p">:</span>
        <span class="n">add_accessor_fn</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">inst</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">FILENAME</span> <span class="o">=</span> <span class="s1">&#39;/home/slottad/nist/gitlab/msdc_services/libraries/test.parquet&#39;</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">pq</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="n">FILENAME</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>charge</th>
      <th>ev</th>
      <th>instrument</th>
      <th>instrument_type</th>
      <th>ion_mode</th>
      <th>ionization</th>
      <th>name</th>
      <th>scan</th>
      <th>nce</th>
      <th>...</th>
      <th>precursor_intensity</th>
      <th>precursor_massinfo</th>
      <th>precursor_mz</th>
      <th>spectrum_fp</th>
      <th>spectrum_fp_count</th>
      <th>spectrum_interval_fp</th>
      <th>spectrum_interval_fp_count</th>
      <th>peptide</th>
      <th>mod_names</th>
      <th>mod_positions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2</td>
      <td>50.0</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>AAAALGSHGSCSSEVEK/2_1(10,C,Carbamidomethyl)</td>
      <td>None</td>
      <td>34.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>{'tolerance': 10.0, 'tolerance_type': 'ppm', '...</td>
      <td>830.8834</td>
      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>
      <td>67</td>
      <td>None</td>
      <td>NaN</td>
      <td>AAAALGSHGSCSSEVEK</td>
      <td>[Carbamidomethyl]</td>
      <td>[10]</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 24 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">.</span><span class="n">column_names</span>
<span class="n">table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;annotations&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">type</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
LargeListType(large_list&lt;item: struct&lt;ion_type: dictionary&lt;values=string, indices=int32, ordered=0&gt;, product_charge: int8, isotope: uint8, neutral_loss: dictionary&lt;values=string, indices=int32, ordered=0&gt;, position: uint16, end_position: uint16, aa_before: dictionary&lt;values=string, indices=int32, ordered=0&gt;, aa_after: dictionary&lt;values=string, indices=int32, ordered=0&gt;, ptm_before: dictionary&lt;values=string, indices=int32, ordered=0&gt;, ptm_after: dictionary&lt;values=string, indices=int32, ordered=0&gt;&gt;&gt;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">FILENAME</span> <span class="o">=</span> <span class="s1">&#39;/home/slottad/nist/gitlab/msdc_services/libraries/test.parquet&#39;</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">pq</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="n">FILENAME</span><span class="p">)</span>
<span class="n">rv</span> <span class="o">=</span> <span class="n">row_view</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;junk&quot;</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;annotations&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;annotations&quot;</span><span class="p">)())</span>
<span class="n">rv</span><span class="o">.</span><span class="n">spectrum_fp</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
None
&lt;bound method row_view.&lt;locals&gt;.add_accessor_fn.&lt;locals&gt;.fn_list of &lt;__main__.row_view.&lt;locals&gt;.row_accessor object at 0x7fede011f280&gt;&gt;
None
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0, 0, 0, ..., 0, 0, 0], dtype=uint8)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">masskit.utils.tables</span>
<span class="n">row</span> <span class="o">=</span> <span class="n">masskit</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">tables</span><span class="o">.</span><span class="n">row_view</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
<span class="n">annotations</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;annotations&quot;</span><span class="p">)</span>
<span class="n">annotations</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">annotations</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">annotations</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">annotations</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
None
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">create_dataset</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">])</span>
<span class="n">st</span> <span class="o">=</span> <span class="n">table_to_struct</span><span class="p">(</span><span class="n">create_dataset</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;john&#39;</span><span class="p">,</span><span class="s1">&#39;paul&#39;</span><span class="p">,</span><span class="s1">&#39;george&#39;</span><span class="p">,</span> <span class="s1">&#39;ringo&#39;</span><span class="p">]))</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">append_column</span><span class="p">(</span><span class="s2">&quot;struct&quot;</span><span class="p">,</span> <span class="n">st</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="c1">#for i in range(st.type.num_fields):</span>
<span class="c1">#    print(type(st.field(i)))</span>

<span class="n">rv</span> <span class="o">=</span> <span class="n">row_view</span><span class="p">(</span><span class="n">table</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>struct</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48</td>
      <td>0.001494</td>
      <td>[0.20078429307909185, 0.2973041209842645, 0.35...</td>
      <td>{'john': 42, 'paul': 0.6673878459460242, 'geor...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>36</td>
      <td>0.721606</td>
      <td>[0.10996359120768118, 0.07010583536064863, 0.6...</td>
      <td>{'john': 72, 'paul': 0.833692180317162, 'georg...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>33</td>
      <td>0.528356</td>
      <td>[0.9182266825707263, 0.9205364956867594, 0.135...</td>
      <td>{'john': 48, 'paul': 0.1061943272679774, 'geor...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>98</td>
      <td>0.629610</td>
      <td>[0.8861506835702156, 0.16536409319567535, 0.04...</td>
      <td>{'john': 84, 'paul': 0.08614252513341736, 'geo...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>81</td>
      <td>0.708453</td>
      <td>[0.06307277064204375, 0.07555214819223965, 0.1...</td>
      <td>{'john': 11, 'paul': 0.08171056669971388, 'geo...</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rv</span><span class="o">.</span><span class="n">idx</span><span class="o">=</span><span class="mi">3</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">struct</span><span class="o">.</span><span class="n">john</span><span class="p">())</span>
<span class="n">rv</span><span class="o">.</span><span class="n">idx</span><span class="o">=</span><span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">struct</span><span class="o">.</span><span class="n">john</span><span class="p">())</span>
<span class="n">rv</span><span class="o">.</span><span class="n">idx</span><span class="o">=</span><span class="mi">0</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">struct</span><span class="o">.</span><span class="n">john</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
84
72
42
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
pyarrow.lib.Int64Array
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">.</span><span class="n">take</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>struct</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>69</td>
      <td>0.757979</td>
      <td>[0.7221621069643587, 0.49276953377866217, 0.34...</td>
      <td>{'john': 23, 'paul': 0.02773443650653218, 'geo...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>0.571250</td>
      <td>[0.8241675056126545, 0.5230640134311503, 0.358...</td>
      <td>{'john': 47, 'paul': 0.9859014647172522, 'geor...</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">pa</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">index_in</span><span class="p">([</span><span class="mi">69</span><span class="p">,</span><span class="mi">66</span><span class="p">],</span><span class="n">value_set</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)))</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>struct</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>69</td>
      <td>0.757979</td>
      <td>[0.7221621069643587, 0.49276953377866217, 0.34...</td>
      <td>{'john': 23, 'paul': 0.02773443650653218, 'geo...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>66</td>
      <td>0.915094</td>
      <td>[0.2957497334359308, 0.5664697231529493, 0.175...</td>
      <td>{'john': 30, 'paul': 0.5000038576126775, 'geor...</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[198]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">row_copy</span><span class="p">(</span><span class="n">view</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">Row_Copy</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="n">cp</span> <span class="o">=</span> <span class="n">Row_Copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">view</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">column_names</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">type</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="s2">&quot;get_&quot;</span><span class="o">+</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pa</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_struct</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">cp</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">f</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">cp</span>

<span class="n">cp</span> <span class="o">=</span> <span class="n">row_copy</span><span class="p">(</span><span class="n">rv</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[202]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#dir(cp)</span>
<span class="n">cp</span><span class="o">.</span><span class="n">c</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[202]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0.85955441, 0.28593158, 0.10857431, 0.55889507, 0.1799482 ,
       0.33433689, 0.15701087, 0.44872635, 0.46481567, 0.01582985,
       0.90253203, 0.58748081, 0.22897347, 0.57033914])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[199]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#cp.get_a()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_112299/1228897693.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>cp<span class="ansi-blue-fg">.</span>get_a<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">AttributeError</span>: &#39;Row_Copy&#39; object has no attribute &#39;get_a&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">create_dataset</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">])</span>
<span class="n">table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>29</td>
      <td>44</td>
    </tr>
    <tr>
      <th>1</th>
      <td>72</td>
      <td>6</td>
      <td>19</td>
    </tr>
    <tr>
      <th>2</th>
      <td>88</td>
      <td>94</td>
      <td>48</td>
    </tr>
    <tr>
      <th>3</th>
      <td>40</td>
      <td>81</td>
      <td>81</td>
    </tr>
    <tr>
      <th>4</th>
      <td>36</td>
      <td>8</td>
      <td>76</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ca</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ca</span><span class="o">.</span><span class="n">iterchunks</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="n">table</span><span class="o">.</span><span class="n">append_column</span><span class="p">(</span><span class="s2">&quot;A+B&quot;</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)))</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class &#39;pyarrow.lib.Int64Array&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>A+B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>29</td>
      <td>44</td>
      <td>31</td>
    </tr>
    <tr>
      <th>1</th>
      <td>72</td>
      <td>6</td>
      <td>19</td>
      <td>78</td>
    </tr>
    <tr>
      <th>2</th>
      <td>88</td>
      <td>94</td>
      <td>48</td>
      <td>182</td>
    </tr>
    <tr>
      <th>3</th>
      <td>40</td>
      <td>81</td>
      <td>81</td>
      <td>121</td>
    </tr>
    <tr>
      <th>4</th>
      <td>36</td>
      <td>8</td>
      <td>76</td>
      <td>44</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">struct</span> <span class="o">=</span> <span class="n">table_to_struct</span><span class="p">(</span><span class="n">create_dataset</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">int_cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">float_cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">str_cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">list_cols</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">table2</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">append_column</span><span class="p">(</span><span class="s2">&quot;struct&quot;</span><span class="p">,</span> <span class="n">struct</span><span class="p">)</span>
<span class="n">table2</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>struct</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>11</td>
      <td>0.639198</td>
      <td>XpEfneOQhrBoWcaCJMNQlvt</td>
      <td>[0.39987697851536186, 0.4402834411641544, 0.86...</td>
      <td>{'a': 72, 'b': 0.6525063345471586, 'c': 'TbNOL...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>73</td>
      <td>0.868861</td>
      <td>FeFrYihRlXpqJYyGqZJQ</td>
      <td>[0.4967560745720806, 0.7240392079967856, 0.340...</td>
      <td>{'a': 93, 'b': 0.5686280599198626, 'c': 'YINfu...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>32</td>
      <td>0.119972</td>
      <td>VTlomANSIFvscENhJtZjSY</td>
      <td>[0.9969064284866098, 0.8052034681531476, 0.156...</td>
      <td>{'a': 54, 'b': 0.08464787277823116, 'c': 'xTIO...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>94</td>
      <td>0.909148</td>
      <td>VtbPAIaBhga</td>
      <td>[0.07506368133485275, 0.9910808511500584, 0.96...</td>
      <td>{'a': 66, 'b': 0.8478686528237297, 'c': 'RrsXg...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>24</td>
      <td>0.782777</td>
      <td>tGAYLOaD</td>
      <td>[0.4230672815939629, 0.27641148498436097, 0.18...</td>
      <td>{'a': 36, 'b': 0.8617662177082072, 'c': 'toTeb...</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rv</span> <span class="o">=</span> <span class="n">row_view</span><span class="p">(</span><span class="n">table2</span><span class="p">)</span>
<span class="n">rv</span><span class="o">.</span><span class="n">get_b</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.6391978724061399
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rv</span> <span class="o">=</span> <span class="n">row_view_raw</span><span class="p">(</span><span class="n">table2</span><span class="p">)</span>
<span class="n">rv</span><span class="o">.</span><span class="n">get_struct</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;pyarrow.StructScalar: [(&#39;a&#39;, 72), (&#39;b&#39;, 0.6525063345471586), (&#39;c&#39;, &#39;TbNOLqlyxXKNhmnPDpWQ&#39;), (&#39;d&#39;, [0.4045044797519384, 0.21629264136170423, 0.16584800697438495, 0.7311778425124787, 0.8529078326022611]), (&#39;e&#39;, [0.8187544196499349, 0.3233499571494465, 0.8988986379419162, 0.964906819933289, 0.04065977124021247, 0.09221913178861774, 0.19247231719030222, 0.07592502003581436, 0.3527969574839216, 0.0764040653279584, 0.37691108037276455, 0.4312023279017151, 0.1867603083182503, 0.35385953664313974, 0.19359362425320203, 0.9532941446945833, 0.019388215071460713, 0.9890492029539549, 0.8031068064140932])]&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">st</span> <span class="o">=</span> <span class="n">rv</span><span class="o">.</span><span class="n">get_struct</span><span class="p">()</span>
<span class="n">st</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;a&#39;: 72,
 &#39;b&#39;: 0.6525063345471586,
 &#39;c&#39;: &#39;TbNOLqlyxXKNhmnPDpWQ&#39;,
 &#39;d&#39;: [0.4045044797519384,
  0.21629264136170423,
  0.16584800697438495,
  0.7311778425124787,
  0.8529078326022611],
 &#39;e&#39;: [0.8187544196499349,
  0.3233499571494465,
  0.8988986379419162,
  0.964906819933289,
  0.04065977124021247,
  0.09221913178861774,
  0.19247231719030222,
  0.07592502003581436,
  0.3527969574839216,
  0.0764040653279584,
  0.37691108037276455,
  0.4312023279017151,
  0.1867603083182503,
  0.35385953664313974,
  0.19359362425320203,
  0.9532941446945833,
  0.019388215071460713,
  0.9890492029539549,
  0.8031068064140932]}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">st</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&#39;a&#39;, &lt;pyarrow.Int64Scalar: 72&gt;)
(&#39;b&#39;, &lt;pyarrow.DoubleScalar: 0.6525063345471586&gt;)
(&#39;c&#39;, &lt;pyarrow.StringScalar: &#39;TbNOLqlyxXKNhmnPDpWQ&#39;&gt;)
(&#39;d&#39;, &lt;pyarrow.ListScalar: [0.4045044797519384, 0.21629264136170423, 0.16584800697438495, 0.7311778425124787, 0.8529078326022611]&gt;)
(&#39;e&#39;, &lt;pyarrow.ListScalar: [0.8187544196499349, 0.3233499571494465, 0.8988986379419162, 0.964906819933289, 0.04065977124021247, 0.09221913178861774, 0.19247231719030222, 0.07592502003581436, 0.3527969574839216, 0.0764040653279584, 0.37691108037276455, 0.4312023279017151, 0.1867603083182503, 0.35385953664313974, 0.19359362425320203, 0.9532941446945833, 0.019388215071460713, 0.9890492029539549, 0.8031068064140932]&gt;)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df = create_dataframe(rows=13)</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="c1"># table = create_dataset(rows=500, int_cols=5, float_cols=4, str_cols=2)</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">create_dataset</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">int_cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">float_cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">str_cols</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">create_dataset</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">int_cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">float_cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">str_cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">list_cols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="c1"># display(df)</span>
<span class="c1"># print(table.schema)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape: </span><span class="si">{</span><span class="n">table</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MB: </span><span class="si">{</span><span class="n">table</span><span class="o">.</span><span class="n">nbytes</span><span class="o">/</span><span class="p">(</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Create dataset time elapsed: </span><span class="si">{</span><span class="n">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">column_names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">schema</span><span class="p">)</span>
<span class="c1"># print(st)</span>

<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

<span class="c1"># Timing functions</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">pq</span><span class="o">.</span><span class="n">write_table</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="s2">&quot;junk_test.parquet&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;2.0&quot;</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Write dataset time elapsed: </span><span class="si">{</span><span class="n">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">table2</span> <span class="o">=</span> <span class="n">pq</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s2">&quot;junk_test.parquet&quot;</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Read dataset time elapsed: </span><span class="si">{</span><span class="n">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">st</span> <span class="o">=</span> <span class="n">table_to_struct</span><span class="p">(</span><span class="n">table2</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dataset to struct time elapsed: </span><span class="si">{</span><span class="n">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">())</span>
<span class="c1"># display(st)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">table3</span> <span class="o">=</span> <span class="n">struct_to_table</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Struct to dataset time elapsed: </span><span class="si">{</span><span class="n">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># print(table3.to_pandas())</span>
<span class="n">display</span><span class="p">(</span><span class="n">table3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">pyarrow</span> <span class="k">as</span> <span class="nn">pa</span>
<span class="kn">import</span> <span class="nn">pyarrow.parquet</span> <span class="k">as</span> <span class="nn">pq</span>
<span class="kn">import</span> <span class="nn">pyarrow.compute</span> <span class="k">as</span> <span class="nn">pc</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;/home/slottad/nist/gitlab/msdc_services/libraries/src&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">masskit.spectrum</span> <span class="kn">import</span> <span class="n">spectrum</span>
<span class="kn">from</span> <span class="nn">masskit.utils.files</span> <span class="kn">import</span> <span class="n">load_sdf2array</span>

<span class="n">FILENAME</span> <span class="o">=</span> <span class="s1">&#39;/data/aiomics/search/libraries/small.sdf&#39;</span>
<span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">er</span><span class="p">,</span> <span class="n">mzr</span><span class="p">)</span> <span class="o">=</span> <span class="n">load_sdf2array</span><span class="p">(</span><span class="n">FILENAME</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s2">&quot;precursor_mz&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0    1467.0061
1    1467.0061
2    1467.0061
3    1467.0061
4    1467.0061
Name: precursor_mz, dtype: float64
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">()</span><span class="o">.</span><span class="n">from_arrow</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/arrow_structs_25_0.svg" src="_images/arrow_structs_25_0.svg" /></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">precursor</span><span class="o">.</span><span class="n">mz</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1467.0061
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">dir</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;__class__&#39;,
 &#39;__delattr__&#39;,
 &#39;__dict__&#39;,
 &#39;__dir__&#39;,
 &#39;__doc__&#39;,
 &#39;__eq__&#39;,
 &#39;__format__&#39;,
 &#39;__ge__&#39;,
 &#39;__getattribute__&#39;,
 &#39;__gt__&#39;,
 &#39;__hash__&#39;,
 &#39;__init__&#39;,
 &#39;__init_subclass__&#39;,
 &#39;__le__&#39;,
 &#39;__lt__&#39;,
 &#39;__module__&#39;,
 &#39;__ne__&#39;,
 &#39;__new__&#39;,
 &#39;__reduce__&#39;,
 &#39;__reduce_ex__&#39;,
 &#39;__repr__&#39;,
 &#39;__setattr__&#39;,
 &#39;__sizeof__&#39;,
 &#39;__slotnames__&#39;,
 &#39;__str__&#39;,
 &#39;__subclasshook__&#39;,
 &#39;__weakref__&#39;,
 &#39;_filtered&#39;,
 &#39;_props&#39;,
 &#39;_repr_png_&#39;,
 &#39;_repr_svg_&#39;,
 &#39;change_mass_info&#39;,
 &#39;charge&#39;,
 &#39;collision_energy&#39;,
 &#39;collision_gas&#39;,
 &#39;column&#39;,
 &#39;composite_score&#39;,
 &#39;copy&#39;,
 &#39;cosine_score&#39;,
 &#39;estimated_ri&#39;,
 &#39;estimated_ri_error&#39;,
 &#39;ev&#39;,
 &#39;evenly_space&#39;,
 &#39;exact_mass&#39;,
 &#39;experimental_ri&#39;,
 &#39;experimental_ri_data&#39;,
 &#39;experimental_ri_error&#39;,
 &#39;filter&#39;,
 &#39;filtered&#39;,
 &#39;formula&#39;,
 &#39;from_arrays&#39;,
 &#39;from_arrow&#39;,
 &#39;from_mol&#39;,
 &#39;get_float_prop&#39;,
 &#39;get_int_prop&#39;,
 &#39;get_prop&#39;,
 &#39;get_string_prop&#39;,
 &#39;id&#39;,
 &#39;identity&#39;,
 &#39;inchi_key&#39;,
 &#39;insource_voltage&#39;,
 &#39;instrument&#39;,
 &#39;instrument_type&#39;,
 &#39;intersect&#39;,
 &#39;ion_mode&#39;,
 &#39;ionization&#39;,
 &#39;mask&#39;,
 &#39;merge&#39;,
 &#39;name&#39;,
 &#39;nce&#39;,
 &#39;norm&#39;,
 &#39;num_ions&#39;,
 &#39;parent_filter&#39;,
 &#39;plot&#39;,
 &#39;precursor&#39;,
 &#39;precursor_class&#39;,
 &#39;precursor_mass_info&#39;,
 &#39;precursor_type&#39;,
 &#39;product_class&#39;,
 &#39;product_mass_info&#39;,
 &#39;products&#39;,
 &#39;props&#39;,
 &#39;retention_time&#39;,
 &#39;sample_inlet&#39;,
 &#39;search_spectra&#39;,
 &#39;shift_mz&#39;,
 &#39;single_match&#39;,
 &#39;spectrum_type&#39;,
 &#39;stdnp&#39;,
 &#39;stdnp_data&#39;,
 &#39;stdnp_error&#39;,
 &#39;stdpolar&#39;,
 &#39;stdpolar_data&#39;,
 &#39;stdpolar_error&#39;,
 &#39;synonyms&#39;,
 &#39;to_msp&#39;,
 &#39;total_intensity&#39;,
 &#39;vial_id&#39;,
 &#39;weighted_intensity&#39;,
 &#39;windowed_filter&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">.</span><span class="n">column_names</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;id&#39;,
 &#39;charge&#39;,
 &#39;ev&#39;,
 &#39;instrument&#39;,
 &#39;instrument_type&#39;,
 &#39;ion_mode&#39;,
 &#39;ionization&#39;,
 &#39;name&#39;,
 &#39;nce&#39;,
 &#39;intensity&#39;,
 &#39;product_massinfo&#39;,
 &#39;mz&#39;,
 &#39;precursor_intensity&#39;,
 &#39;precursor_massinfo&#39;,
 &#39;precursor_mz&#39;,
 &#39;spectrum_fp&#39;,
 &#39;spectrum_fp_count&#39;,
 &#39;spectrum_interval_fp&#39;,
 &#39;spectrum_interval_fp_count&#39;,
 &#39;aromatic_rings&#39;,
 &#39;collision_energy&#39;,
 &#39;collision_gas&#39;,
 &#39;column&#39;,
 &#39;ecfp4&#39;,
 &#39;ecfp4_count&#39;,
 &#39;estimated_ri&#39;,
 &#39;estimated_ri_error&#39;,
 &#39;exact_mass&#39;,
 &#39;exact_mw&#39;,
 &#39;experimental_ri&#39;,
 &#39;experimental_ri_data&#39;,
 &#39;experimental_ri_error&#39;,
 &#39;formula&#39;,
 &#39;has_2d&#39;,
 &#39;has_conformer&#39;,
 &#39;has_tms&#39;,
 &#39;hba&#39;,
 &#39;hbd&#39;,
 &#39;inchi_key&#39;,
 &#39;inchi_key_orig&#39;,
 &#39;insource_voltage&#39;,
 &#39;isomeric_smiles&#39;,
 &#39;mol&#39;,
 &#39;num_atoms&#39;,
 &#39;num_undef_double&#39;,
 &#39;num_undef_stereo&#39;,
 &#39;rotatable_bonds&#39;,
 &#39;sample_inlet&#39;,
 &#39;set&#39;,
 &#39;smiles&#39;,
 &#39;stdnp&#39;,
 &#39;stdnp_data&#39;,
 &#39;stdnp_error&#39;,
 &#39;stdpolar&#39;,
 &#39;stdpolar_data&#39;,
 &#39;stdpolar_error&#39;,
 &#39;synonyms&#39;,
 &#39;tpsa&#39;,
 &#39;vial_id&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;precursor_mz&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>precursor_mz</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1035166</td>
      <td>1',3'-Bis[1,2-dilinoleoyl-sn-glycero-3-phospho...</td>
      <td>1467.0061</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1035167</td>
      <td>1',3'-Bis[1,2-dilinoleoyl-sn-glycero-3-phospho...</td>
      <td>1467.0061</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1035168</td>
      <td>1',3'-Bis[1,2-dilinoleoyl-sn-glycero-3-phospho...</td>
      <td>1467.0061</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1035169</td>
      <td>1',3'-Bis[1,2-dilinoleoyl-sn-glycero-3-phospho...</td>
      <td>1467.0061</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1035170</td>
      <td>1',3'-Bis[1,2-dilinoleoyl-sn-glycero-3-phospho...</td>
      <td>1467.0061</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">masskit.utils.tables</span> <span class="kn">import</span> <span class="n">row_view</span>
<span class="n">row</span> <span class="o">=</span> <span class="n">row_view</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">row</span><span class="o">.</span><span class="n">precursor_massinfo</span><span class="p">()</span><span class="o">.</span><span class="n">tolerance</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
10.0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">dir</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">product_massinfo</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;__class__&#39;,
 &#39;__delattr__&#39;,
 &#39;__dict__&#39;,
 &#39;__dir__&#39;,
 &#39;__doc__&#39;,
 &#39;__eq__&#39;,
 &#39;__format__&#39;,
 &#39;__ge__&#39;,
 &#39;__getattribute__&#39;,
 &#39;__gt__&#39;,
 &#39;__hash__&#39;,
 &#39;__init__&#39;,
 &#39;__init_subclass__&#39;,
 &#39;__le__&#39;,
 &#39;__lt__&#39;,
 &#39;__module__&#39;,
 &#39;__ne__&#39;,
 &#39;__new__&#39;,
 &#39;__reduce__&#39;,
 &#39;__reduce_ex__&#39;,
 &#39;__repr__&#39;,
 &#39;__setattr__&#39;,
 &#39;__sizeof__&#39;,
 &#39;__str__&#39;,
 &#39;__subclasshook__&#39;,
 &#39;__weakref__&#39;,
 &#39;evenly_spaced&#39;,
 &#39;get&#39;,
 &#39;mass_type&#39;,
 &#39;neutral_loss&#39;,
 &#39;neutral_loss_charge&#39;,
 &#39;struct&#39;,
 &#39;tolerance&#39;,
 &#39;tolerance_type&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">row</span><span class="o">.</span><span class="n">product_massinfo</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tolerance&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;bound method struct_view.&lt;locals&gt;.add_accessor_fn.&lt;locals&gt;.fn_scalar of &lt;masskit.utils.tables.struct_view.&lt;locals&gt;.struct_accessor object at 0x7f0946820c40&gt;&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">create_dataset</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span><span class="n">rows</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">nbytes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
160
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;Why is my car still dirty?&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">table</span><span class="o">.</span><span class="n">num_rows</span><span class="p">)</span>
<span class="c1">#col = pa.array([&quot;Why is my car still dirty?&quot;] * table.num_rows).dictionary_encode()</span>
<span class="n">col</span><span class="o">.</span><span class="n">nbytes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
604
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;pyarrow.lib.StructArray object at 0x7fb52f6d3820&gt;
-- is_valid: all not null
-- child 0 type: string
  [
    &#34;Why is my car still dirty?&#34;
  ]
-- child 1 type: int64
  [
    20
  ]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;pyarrow.lib.StringArray object at 0x7fb52f689760&gt;
[
  &#34;Why is my car still dirty?&#34;,
  &#34;Why is my car still dirty?&#34;,
  &#34;Why is my car still dirty?&#34;,
  &#34;Why is my car still dirty?&#34;,
  &#34;Why is my car still dirty?&#34;,
  &#34;Why is my car still dirty?&#34;,
  &#34;Why is my car still dirty?&#34;,
  &#34;Why is my car still dirty?&#34;,
  &#34;Why is my car still dirty?&#34;,
  &#34;Why is my car still dirty?&#34;,
  &#34;Why is my car still dirty?&#34;,
  &#34;Why is my car still dirty?&#34;,
  &#34;Why is my car still dirty?&#34;,
  &#34;Why is my car still dirty?&#34;,
  &#34;Why is my car still dirty?&#34;,
  &#34;Why is my car still dirty?&#34;,
  &#34;Why is my car still dirty?&#34;,
  &#34;Why is my car still dirty?&#34;,
  &#34;Why is my car still dirty?&#34;,
  &#34;Why is my car still dirty?&#34;
]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col</span><span class="o">.</span><span class="n">get_total_buffer_size</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
Input <span class="ansi-green-fg">In [20]</span>, in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">col</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">get_total_buffer_size</span>()

<span class="ansi-red-fg">AttributeError</span>: &#39;pyarrow.lib.StringArray&#39; object has no attribute &#39;get_total_buffer_size&#39;
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/arrow_structs.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">masskit 1.2.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">&lt;no title&gt;</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    </div>
  </body>
</html>